.PHONY : all clean 

CC = i686-w64-mingw32-gcc 
CFLAGS = -g -Wall -fPIC -DNOUSE_JEMALLOC -I3rd/lua-5.3.2/src -Icore -Icore/net
LDFLAGS = *.a -L3rd/lua-5.3.2/src -llua -lpthread -ldl -lm #lua调用了标准数学库 -lm


all : \
	libnet.a \
	uboss

libnet.a : \
	core/net/socket_server.c
	$(CC) $(CFLAGS) -c $^ 
	x86_64-linux-gnu-ar rcv $@ \
	socket_server.o
	ranlib $@
	rm *.o

uboss : \
	core/malloc_hook.c \
	core/skynet_daemon.c \
	core/skynet_env.c \
	core/skynet_error.c \
	core/skynet_handle.c \
	core/skynet_harbor.c \
	core/skynet_log.c \
	core/skynet_main.c \
	core/skynet_module.c \
	core/skynet_monitor.c \
	core/skynet_mq.c \
	core/skynet_start.c \
	core/skynet_server.c \
	core/skynet_timer.c \
	core/skynet_socket.c 
	$(CC) $(CFLAGS) -c $^
	$(CC) $(CFLAGS) -o $@ \
	*.o $(LDFLAGS)
	rm *.o

clean :
	rm *.o *.a uboss
